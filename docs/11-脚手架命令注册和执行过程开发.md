# 脚手架命令注册和执行过程开发

## 当前脚手架架构痛点

init 是动态的，每个团队的 init 是自己开发的。需要去动态加载各个团队的 init 包进行执行。如

- A 团队是 @a/init
- B 团队是 @b/init

![](./imgs/2022-06-14-22-49-59.png)

![](./imgs/2022-06-14-22-56-44.png)

## 增加 targetPath

1. 增加 option 参数

```js
.option('-tp, --targetPath <targetPath>', '是否指定本地调试文件路径', '')
```

2. 监听 targetPath

```js
program.on("option:targetPath", () => {
  const tp = program.getOptionValue("targetPath");
  if (tp) {
    progress.env.CLI_TARGET_PATH = tp;
  }
});
```

3. 在 `@v-cli/init` 中打印 process.env.CLI_TARGET_PATH, 可以得到值。

## 创建 @v-cli/exec 包

```
lerna create exec core
```

## 创建 @v-cli/package 包

```
lerna create package models
```
